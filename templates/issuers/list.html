{% extends "base.html" %}

{% block title %}Card Issuers - VPass{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/css/issuers.css">
{% endblock %}

{% block content %}
    <div class="header">
        <h1>Card Issuers</h1>
        <a href="/issuers/new" class="btn btn-primary">Create Issuer</a>
    </div>

    {% if issuers.is_empty() %}
        <div class="empty">
            <p>No issuers yet.</p>
            <a href="/issuers/new" class="btn btn-primary">Create First Issuer</a>
        </div>
    {% else %}
        <div class="issuers">
            {% for issuer in issuers %}
                <div class="issuer-card">
                    <div class="issuer-header">
                        <h3>{{ issuer.channel_name }}</h3>
                        <span class="status {% if issuer.is_active %}active{% else %}inactive{% endif %}">
                            {% if issuer.is_active %}Active{% else %}Inactive{% endif %}
                        </span>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="label">Channel ID</span>
                            <span class="value">{{ issuer.youtube_channel_id }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Handle</span>
                            <span class="value">{{ issuer.channel_handle.as_deref().unwrap_or("N/A") }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Verification Video</span>
                            <span class="value">{{ issuer.verification_video_id }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Default Label</span>
                            <span class="value">{{ issuer.default_membership_label }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Wallet VC UID</span>
                            <span class="value">{{ issuer.vc_uid.as_deref().unwrap_or("Not configured") }}</span>
                        </div>
                    </div>
                    <div class="actions">
                        <a href="/channels/{{ issuer.id }}/claim" class="btn btn-primary">Claim Card</a>
                        <a href="/issuers/{{ issuer.id }}/edit" class="btn btn-secondary">Edit</a>
                        <form action="/issuers/{{ issuer.id }}/toggle" method="POST" style="display: inline;">
                            <button type="submit" class="btn btn-warning">
                                {% if issuer.is_active %}Deactivate{% else %}Activate{% endif %}
                            </button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}
